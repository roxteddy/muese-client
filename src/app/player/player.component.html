<div class="player">
    <div class="info">
        <div class="cover"></div>
        <div class="content">
            <div class="main">
                <div class="title">{{track?.title}}</div>
                <div class="artist">{{track?.artist}}</div>
                <div class="album">Album</div>
            </div>
            <div class="detail">
                <ng-template #trackDetail
                             let-label="label"
                             let-showButtons="showButtons"
                             let-disableButtons="disableButtons"
                             let-value="value">
                    <div class="track-detail">
                        <div class="label">{{label}}</div>
                        <div class="value-wrapper">
                            <div *ngIf="showButtons"
                                 class="btn-min"
                                 [ngClass]="{disabled: disableButtons}"
                                 (click)="onButtonClick(label, -1)">âˆ’</div>
                            <div class="value"><div class="text">{{value}}</div></div>
                            <div *ngIf="showButtons"
                                 class="btn-plus"
                                 [ngClass]="{disabled: disableButtons}"
                                 (click)="onButtonClick(label, 1)">&#43;</div>
                        </div>
                    </div>
                </ng-template>
                <ng-container  [ngTemplateOutlet]="trackDetail"
                               [ngTemplateOutletContext]="{
                                    label: 'Signature',
                                    showButtons: false,
                                    value: '4/4'}">
                </ng-container>
                <ng-container  [ngTemplateOutlet]="trackDetail"
                               [ngTemplateOutletContext]="{
                                    label: 'BPM',
                                    showButtons: true,
                                    value: getBPMValue(track)}">
                </ng-container>
                <ng-container  [ngTemplateOutlet]="trackDetail"
                               [ngTemplateOutletContext]="{
                                    label: 'Key',
                                    showButtons: true,
                                    value: pitch}">
                </ng-container>
            </div>
        </div>
    </div>

    <div class="commands">
        <div class="buttons">
            <div class="activable">
                <button mat-icon-button disabled>
                    <mat-icon>text_fields</mat-icon>
                </button>
                <button mat-icon-button
                        [ngClass]="{active: loopActivated}"
                        (click)="loopActivated = !loopActivated">
                    <mat-icon>loop</mat-icon>
                </button>
                <button mat-icon-button
                        [ngClass]="{active: shuffleActivated}"
                        (click)="shuffleActivated = !shuffleActivated">
                    <mat-icon>shuffle</mat-icon>
                </button>
            </div>
            <div class="clickable">
                <button mat-icon-button
                        (click)="onPrev()">
                    <mat-icon>skip_previous</mat-icon>
                </button>
                <button mat-fab id="play-button" (click)="playPause()" [disabled]="!ready">
                    <mat-icon>{{paused ? 'play_arrow' : 'pause'}}</mat-icon>
                </button>
                <button mat-icon-button
                        (click)="onNext()">
                    <mat-icon>skip_next</mat-icon>
                </button>
            </div>
            <div class="volume">
                <mat-icon>speaker</mat-icon>

                <app-ui-progress-bar
                    [emitSeekOnDrag]="true"
                    [emitSeekOnWheel]="true"
                    [hasButton]="true"
                    [seek]="volume"
                    (progress)="onVolumeProgress($event)"
                ></app-ui-progress-bar>
            </div>
        </div>
        <div class="progress">
            <div class="timer">{{duration * progress / speed | date: 'mm:ss'}}</div>
            <app-ui-progress-bar
                [emitSeekOnDrag]="true"
                [hasButton]="true"
                [scrollGranularity]="duration ? (1000 / duration * 5) : 0"
                [seek]="dragData ? dragData.progress : progress"
                (progress)="onProgressBarChange($event)"
            ></app-ui-progress-bar>
            <div class="timer">{{duration / speed | date:'mm:ss'}}</div>
        </div>

    </div>
</div>
<div class="tracks">
    <app-stem-player *ngFor="let key of Object.keys(stemPlayers)"
        [dragData]="dragData"
        [progress]="progress"
        [stem]="stemPlayers[key].stem"
        [title]="key"
        [trackFilename]="track?.filename || ''"
        (dragStatus)="onDragEvent($event)"
        (loaded)="onTrackLoaded(key)"
        (progressChange)="onProgressChange($event)"
        (solo)="onSolo($event)"
    >
    </app-stem-player>
</div>
