<div class="player">
    <div class="info">
        <div class="cover"></div>
        <div class="content">
            <div class="main">
                <div class="title">{{song?.title}}</div>
                <div class="artist">{{song?.artist}}</div>
                <div class="album">Album</div>
            </div>
            <div class="detail">
                <ng-template #songDetail
                             let-label="label"
                             let-showButtons="showButtons"
                             let-disableButtons="disableButtons"
                             let-value="value">
                    <div class="song-detail">
                        <div class="label">{{label}}</div>
                        <div class="value-wrapper">
                            <div *ngIf="showButtons" class="btn-min" [ngClass]="{disabled :disableButtons}">−</div>
                            <div class="value"><div class="text">{{value}}</div></div>
                            <div *ngIf="showButtons" class="btn-plus" [ngClass]="{disabled :disableButtons}">&#43;</div>
                        </div>
                    </div>
                </ng-template>
                <ng-container  [ngTemplateOutlet]="songDetail"
                               [ngTemplateOutletContext]="{label: 'Signature', showButtons: false, value: '4/4'}">
                </ng-container>
                <ng-container  [ngTemplateOutlet]="songDetail"
                               [ngTemplateOutletContext]="{label: 'BPM', showButtons: true, disableButtons: true, value: '120'}">
                </ng-container>
                <ng-container  [ngTemplateOutlet]="songDetail"
                               [ngTemplateOutletContext]="{label: 'Key', showButtons: true, value: 'B♯'}">
                </ng-container>
            </div>
        </div>
    </div>

    <div class="commands">
        <div class="buttons">
            <div class="activable">
                <button mat-icon-button disabled>
                    <mat-icon>text_fields</mat-icon>
                </button>
                <button mat-icon-button
                        [ngClass]="{active: loopActivated}"
                        (click)="loopActivated = !loopActivated">
                    <mat-icon>loop</mat-icon>
                </button>
                <button mat-icon-button
                        [ngClass]="{active: shuffleActivated}"
                        (click)="shuffleActivated = !shuffleActivated">
                    <mat-icon>shuffle</mat-icon>
                </button>
            </div>
            <div class="clickable">
                <button mat-icon-button
                        (click)="onPrev()">
                    <mat-icon>skip_previous</mat-icon>
                </button>
                <button mat-fab id="play-button" (click)="playPause()" [disabled]="tracksReady < 5">
                    <mat-icon>{{paused ? 'play_arrow' : 'pause'}}</mat-icon>
                </button>
                <button mat-icon-button
                        (click)="onNext()">
                    <mat-icon>skip_next</mat-icon>
                </button>
            </div>
            <div class="volume">
                <mat-icon>speaker</mat-icon>

                <app-ui-progress-bar
                    [emitSeekOnDrag]="true"
                    [hasButton]="true"
                    [seek]="volume"
                    (progress)="onVolumeProgress($event)"
                ></app-ui-progress-bar>
            </div>
        </div>
        <div class="progress">
            <div class="timer">{{timeProgress * 1000 | date: 'mm:ss'}}</div>
            <app-ui-progress-bar
                [emitSeekOnDrag]="true"
                [seek]="dragData ? dragData.progress : timeProgress / (duration || 1)"
                (progress)="onProgress($event)"
            ></app-ui-progress-bar>
            <div class="timer">{{duration * 1000 | date:'mm:ss'}}</div>
        </div>

    </div>
</div>
<div class="tracks">
    <app-howled-track
        [dragData]="dragData"
        [pauseSubject]="pauseSubject"
        [playSubject]="playSubject"
        [seekSubject]="seekSubject"
        [speedSubject]="speedSubject"
        [title]="'Drums'"
        [url]="getDrumsUrl()"
        (ended)="onSongEnd()"
        (timeProgress)="timeProgress = $event"
        (dragStatus)="onDragEvent($event)"
        (loaded)="onTrackLoaded($event)"
        (timeChange)="onTimeChange($event)"
        (solo)="onSolo($event)">
    </app-howled-track>
    <app-howled-track
        [dragData]="dragData"
        [pauseSubject]="pauseSubject"
        [playSubject]="playSubject"
        [seekSubject]="seekSubject"
        [speedSubject]="speedSubject"
        [title]="'Piano'"
        [url]="getPianoUrl()"
        (dragStatus)="onDragEvent($event)"
        (loaded)="onTrackLoaded()"
        (timeChange)="onTimeChange($event)"
        (solo)="onSolo($event)">
    </app-howled-track>
    <app-howled-track
        [dragData]="dragData"
        [pauseSubject]="pauseSubject"
        [playSubject]="playSubject"
        [seekSubject]="seekSubject"
        [speedSubject]="speedSubject"
        [title]="'Bass'"
        [url]="getBassUrl()"
        (dragStatus)="onDragEvent($event)"
        (loaded)="onTrackLoaded()"
        (timeChange)="onTimeChange($event)"
        (solo)="onSolo($event)">
    </app-howled-track>
    <app-howled-track
        [dragData]="dragData"
        [pauseSubject]="pauseSubject"
        [playSubject]="playSubject"
        [seekSubject]="seekSubject"
        [speedSubject]="speedSubject"
        [title]="'Vocals'"
        [url]="getVocalsUrl()"
        (dragStatus)="onDragEvent($event)"
        (loaded)="onTrackLoaded()"
        (timeChange)="onTimeChange($event)"
        (solo)="onSolo($event)">
    </app-howled-track>
    <app-howled-track
        [dragData]="dragData"
        [pauseSubject]="pauseSubject"
        [playSubject]="playSubject"
        [seekSubject]="seekSubject"
        [speedSubject]="speedSubject"
        [title]="'Other'"
        [url]="getOtherUrl()"
        (dragStatus)="onDragEvent($event)"
        (loaded)="onTrackLoaded()"
        (timeChange)="onTimeChange($event)"
        (solo)="onSolo($event)">
    </app-howled-track>
</div>


<!--<div #speedContainer-->
<!--     class="speed-container"-->
<!--     (mousedown)="onSpeedMouseDown($event, speedContainer)">-->
<!--    <div class="filler-1"></div>-->
<!--    <div class="filler-2"></div>-->
<!--    <div class="speed-progress"-->
<!--         [ngClass]="{dragged: !!speedStatus.rect}"-->
<!--         [style.width.%]="(speedStatus.speed / 4) * 100">-->
<!--    </div>-->
<!--</div>-->
